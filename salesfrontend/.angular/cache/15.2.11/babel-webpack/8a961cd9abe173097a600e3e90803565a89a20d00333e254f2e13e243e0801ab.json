{"ast":null,"code":"import { Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"../sales.service\";\nimport * as i3 from \"@angular/common\";\nfunction SalesFormComponent_ng_container_7_option_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const stage_r5 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(stage_r5);\n  }\n}\nfunction SalesFormComponent_ng_container_7_ng_container_18_ng_container_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelement(1, \"textarea\", 26);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const field_r6 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"formControlName\", field_r6.name);\n  }\n}\nfunction SalesFormComponent_ng_container_7_ng_container_18_ng_container_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"select\", 27)(2, \"option\", 15);\n    i0.ɵɵtext(3, \"Select\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"option\", 28);\n    i0.ɵɵtext(5, \"Yes\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"option\", 29);\n    i0.ɵɵtext(7, \"No\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const field_r6 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"formControlName\", field_r6.name);\n  }\n}\nfunction SalesFormComponent_ng_container_7_ng_container_18_ng_container_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelement(1, \"input\", 30);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const field_r6 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"formControlName\", field_r6.name);\n  }\n}\nfunction SalesFormComponent_ng_container_7_ng_container_18_ng_container_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelement(1, \"input\", 31);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const field_r6 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"formControlName\", field_r6.name);\n  }\n}\nfunction SalesFormComponent_ng_container_7_ng_container_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\", 25)(2, \"div\", 11)(3, \"label\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"div\", 12);\n    i0.ɵɵelement(6, \"i\");\n    i0.ɵɵtemplate(7, SalesFormComponent_ng_container_7_ng_container_18_ng_container_7_Template, 2, 1, \"ng-container\", 6);\n    i0.ɵɵtemplate(8, SalesFormComponent_ng_container_7_ng_container_18_ng_container_8_Template, 8, 1, \"ng-container\", 6);\n    i0.ɵɵtemplate(9, SalesFormComponent_ng_container_7_ng_container_18_ng_container_9_Template, 2, 1, \"ng-container\", 6);\n    i0.ɵɵtemplate(10, SalesFormComponent_ng_container_7_ng_container_18_ng_container_10_Template, 2, 1, \"ng-container\", 6);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const field_r6 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵclassProp(\"col-md-6\", field_r6.name === \"comments\");\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(field_r6.label);\n    i0.ɵɵadvance(2);\n    i0.ɵɵclassMapInterpolate1(\"bi bi-\", field_r6.icon, \" icon\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", field_r6.isTextarea);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", field_r6.isSelect);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !field_r6.isSelect && !field_r6.isTextarea && field_r6.type === \"date\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !field_r6.isSelect && !field_r6.isTextarea && field_r6.type === \"number\");\n  }\n}\nfunction SalesFormComponent_ng_container_7_div_23_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 32)(1, \"div\", 33)(2, \"strong\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const field_r15 = ctx.$implicit;\n    const ctx_r4 = i0.ɵɵnextContext(2);\n    let tmp_1_0;\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\"\", field_r15.label, \":\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ((tmp_1_0 = ctx_r4.salesForm.get(field_r15.name)) == null ? null : tmp_1_0.value) || \"-\", \" \");\n  }\n}\nconst _c0 = function () {\n  return {\n    name: \"comments\",\n    label: \"Comments\",\n    icon: \"chat-dots\",\n    isTextarea: true\n  };\n};\nconst _c1 = function () {\n  return {\n    name: \"nextFollowUpDate\",\n    label: \"Next Follow-up Date\",\n    icon: \"calendar\",\n    type: \"date\"\n  };\n};\nconst _c2 = function () {\n  return {\n    name: \"quotationSent\",\n    label: \"Quotation Sent Y/N\",\n    icon: \"check-square\",\n    isSelect: true\n  };\n};\nconst _c3 = function () {\n  return {\n    name: \"sowSent\",\n    label: \"SOW Sent Y/N\",\n    icon: \"check-square\",\n    isSelect: true\n  };\n};\nconst _c4 = function () {\n  return {\n    name: \"negotiation\",\n    label: \"Negotiation Y/N\",\n    icon: \"check-square\",\n    isSelect: true\n  };\n};\nconst _c5 = function () {\n  return {\n    name: \"dealWon\",\n    label: \"Deal Won (USD)\",\n    icon: \"currency-dollar\",\n    type: \"number\"\n  };\n};\nconst _c6 = function (a0, a1, a2, a3, a4, a5) {\n  return [a0, a1, a2, a3, a4, a5];\n};\nfunction SalesFormComponent_ng_container_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\", 10)(2, \"div\", 11)(3, \"label\");\n    i0.ɵɵtext(4, \"Sales Stage\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"div\", 12);\n    i0.ɵɵelement(6, \"i\", 13);\n    i0.ɵɵelementStart(7, \"select\", 14)(8, \"option\", 15);\n    i0.ɵɵtext(9, \"Select\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(10, SalesFormComponent_ng_container_7_option_10_Template, 2, 1, \"option\", 16);\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵelementStart(11, \"div\", 10)(12, \"div\", 11)(13, \"label\");\n    i0.ɵɵtext(14, \"Event / Lead\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"div\", 12);\n    i0.ɵɵelement(16, \"i\", 17)(17, \"input\", 18);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵtemplate(18, SalesFormComponent_ng_container_7_ng_container_18_Template, 11, 10, \"ng-container\", 16);\n    i0.ɵɵelementStart(19, \"div\", 19)(20, \"h5\", 20);\n    i0.ɵɵtext(21, \"Information\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(22, \"div\", 21);\n    i0.ɵɵtemplate(23, SalesFormComponent_ng_container_7_div_23_Template, 5, 2, \"div\", 22);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(24, \"div\", 23)(25, \"strong\");\n    i0.ɵɵtext(26, \"Comments:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(27, \"pre\", 24);\n    i0.ɵɵtext(28);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(29, \"div\", 23)(30, \"strong\");\n    i0.ɵɵtext(31, \"Deal Won (USD):\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(32);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    let tmp_4_0;\n    i0.ɵɵadvance(10);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.salesStageOptions);\n    i0.ɵɵadvance(8);\n    i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpureFunction6(11, _c6, i0.ɵɵpureFunction0(5, _c0), i0.ɵɵpureFunction0(6, _c1), i0.ɵɵpureFunction0(7, _c2), i0.ɵɵpureFunction0(8, _c3), i0.ɵɵpureFunction0(9, _c4), i0.ɵɵpureFunction0(10, _c5)));\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.uneditableFields);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r0.formattedComments || \"-\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ((tmp_4_0 = ctx_r0.salesForm.get(\"dealWon\")) == null ? null : tmp_4_0.value) || \"-\", \" \");\n  }\n}\nfunction SalesFormComponent_ng_container_8_ng_container_1_span_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 35);\n    i0.ɵɵtext(1, \"*\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction SalesFormComponent_ng_container_8_ng_container_1_ng_container_8_option_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 41);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const option_r25 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", option_r25);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(option_r25);\n  }\n}\nfunction SalesFormComponent_ng_container_8_ng_container_1_ng_container_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"select\", 27)(2, \"option\", 15);\n    i0.ɵɵtext(3, \"Select\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(4, SalesFormComponent_ng_container_8_ng_container_1_ng_container_8_option_4_Template, 2, 2, \"option\", 40);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const field_r18 = i0.ɵɵnextContext().$implicit;\n    const ctx_r20 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"formControlName\", field_r18.name);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r20.opportunityList);\n  }\n}\nfunction SalesFormComponent_ng_container_8_ng_container_1_ng_container_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelement(1, \"input\", 30);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const field_r18 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"formControlName\", field_r18.name);\n  }\n}\nfunction SalesFormComponent_ng_container_8_ng_container_1_ng_container_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelement(1, \"input\", 42);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const field_r18 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"formControlName\", field_r18.name);\n  }\n}\nfunction SalesFormComponent_ng_container_8_ng_container_1_div_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 43);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const field_r18 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", field_r18.label, \" is required. \");\n  }\n}\nfunction SalesFormComponent_ng_container_8_ng_container_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\", 10)(2, \"div\", 11)(3, \"label\");\n    i0.ɵɵtext(4);\n    i0.ɵɵtemplate(5, SalesFormComponent_ng_container_8_ng_container_1_span_5_Template, 2, 0, \"span\", 39);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"div\", 12);\n    i0.ɵɵelement(7, \"i\");\n    i0.ɵɵtemplate(8, SalesFormComponent_ng_container_8_ng_container_1_ng_container_8_Template, 5, 2, \"ng-container\", 6);\n    i0.ɵɵtemplate(9, SalesFormComponent_ng_container_8_ng_container_1_ng_container_9_Template, 2, 1, \"ng-container\", 6);\n    i0.ɵɵtemplate(10, SalesFormComponent_ng_container_8_ng_container_1_ng_container_10_Template, 2, 1, \"ng-container\", 6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(11, SalesFormComponent_ng_container_8_ng_container_1_div_11_Template, 2, 1, \"div\", 38);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const field_r18 = ctx.$implicit;\n    const ctx_r16 = i0.ɵɵnextContext(2);\n    let tmp_6_0;\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", field_r18.label, \" \");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !field_r18.optional);\n    i0.ɵɵadvance(2);\n    i0.ɵɵclassMapInterpolate1(\"bi bi-\", field_r18.icon, \" icon\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", field_r18.isSelect);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !field_r18.isSelect && field_r18.type === \"date\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !field_r18.isSelect && !field_r18.type);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ((tmp_6_0 = ctx_r16.salesForm.get(field_r18.name)) == null ? null : tmp_6_0.touched) && ((tmp_6_0 = ctx_r16.salesForm.get(field_r18.name)) == null ? null : tmp_6_0.hasError(\"required\")));\n  }\n}\nfunction SalesFormComponent_ng_container_8_div_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 43);\n    i0.ɵɵtext(1, \" Comments are required. \");\n    i0.ɵɵelementEnd();\n  }\n}\nconst _c7 = function () {\n  return {\n    name: \"eventLead\",\n    label: \"Event / Lead\",\n    icon: \"lightbulb\"\n  };\n};\nconst _c8 = function () {\n  return {\n    name: \"companyName\",\n    label: \"Company Name\",\n    icon: \"building\"\n  };\n};\nconst _c9 = function () {\n  return {\n    name: \"opportunity\",\n    label: \"Opportunity\",\n    icon: \"bullseye\",\n    isSelect: true\n  };\n};\nconst _c10 = function () {\n  return {\n    name: \"contactPersonName\",\n    label: \"Contact Person Name\",\n    icon: \"person-vcard\"\n  };\n};\nconst _c11 = function () {\n  return {\n    name: \"designation\",\n    label: \"Designation\",\n    icon: \"person-badge\"\n  };\n};\nconst _c12 = function () {\n  return {\n    name: \"mobile\",\n    label: \"Mobile\",\n    icon: \"telephone-fill\"\n  };\n};\nconst _c13 = function () {\n  return {\n    name: \"email\",\n    label: \"Email\",\n    icon: \"envelope\",\n    optional: true\n  };\n};\nconst _c14 = function (a0, a1, a2, a3, a4, a5, a6, a7) {\n  return [a0, a1, a2, a3, a4, a5, a6, a7];\n};\nfunction SalesFormComponent_ng_container_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, SalesFormComponent_ng_container_8_ng_container_1_Template, 12, 9, \"ng-container\", 16);\n    i0.ɵɵelementStart(2, \"div\", 34)(3, \"div\", 11)(4, \"label\");\n    i0.ɵɵtext(5, \"Comments \");\n    i0.ɵɵelementStart(6, \"span\", 35);\n    i0.ɵɵtext(7, \"*\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(8, \"div\", 12);\n    i0.ɵɵelement(9, \"i\", 36)(10, \"textarea\", 37);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(11, SalesFormComponent_ng_container_8_div_11_Template, 2, 0, \"div\", 38);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    let tmp_1_0;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpureFunction8(10, _c14, i0.ɵɵpureFunction0(2, _c7), i0.ɵɵpureFunction0(3, _c8), i0.ɵɵpureFunction0(4, _c9), i0.ɵɵpureFunction0(5, _c10), i0.ɵɵpureFunction0(6, _c11), i0.ɵɵpureFunction0(7, _c12), i0.ɵɵpureFunction0(8, _c13), i0.ɵɵpureFunction0(9, _c1)));\n    i0.ɵɵadvance(10);\n    i0.ɵɵproperty(\"ngIf\", ((tmp_1_0 = ctx_r1.salesForm.get(\"comments\")) == null ? null : tmp_1_0.touched) && ((tmp_1_0 = ctx_r1.salesForm.get(\"comments\")) == null ? null : tmp_1_0.hasError(\"required\")));\n  }\n}\nexport let SalesFormComponent = /*#__PURE__*/(() => {\n  class SalesFormComponent {\n    constructor(fb, service) {\n      this.fb = fb;\n      this.service = service;\n      this.existingData = null;\n      this.editId = null;\n      this.loggedInUser = '';\n      this.formattedComments = '';\n      this.uneditableFields = [{\n        name: 'companyName',\n        label: 'Company Name'\n      }, {\n        name: 'opportunity',\n        label: 'Opportunity'\n      }, {\n        name: 'contactPersonName',\n        label: 'Contact Person Name'\n      }, {\n        name: 'designation',\n        label: 'Designation'\n      }, {\n        name: 'mobile',\n        label: 'Mobile'\n      }, {\n        name: 'email',\n        label: 'Email'\n      }];\n      this.salesStageOptions = ['2) Qualification', '3) proposal', '4) Negotiation', '5) Closed own (Conveted)', '6) Closed Lost'];\n      this.opportunityList = ['AWS', 'AWS - New Account', 'AWS BILL MIGRATE', 'AWS Direct to Our Billing', 'GCP - New Account', 'GWS - New Account', 'GWS - Direct to Our Billing', 'M365', 'M365 - New Account', 'Windows 11 pro', 'Azure'];\n      this.salesForm = this.fb.group({\n        salesName: [''],\n        eventLead: ['', Validators.required],\n        companyName: ['', Validators.required],\n        salesStage: [''],\n        opportunity: ['', Validators.required],\n        contactPersonName: ['', Validators.required],\n        designation: ['', Validators.required],\n        mobile: ['', Validators.required],\n        email: [''],\n        comments: ['', Validators.required],\n        nextFollowUpDate: ['', Validators.required],\n        quotationSent: [''],\n        sowSent: [''],\n        negotiation: [''],\n        dealWon: ['']\n      });\n    }\n    ngOnInit() {\n      this.loggedInUser = localStorage.getItem('userName') || '';\n      if (!this.existingData) {\n        this.salesForm.patchValue({\n          salesName: this.loggedInUser,\n          quotationSent: '',\n          sowSent: '',\n          negotiation: '',\n          salesStage: '1) Lead (Initial Requirement / Gathering)'\n        });\n        this.salesForm.get('salesStage')?.disable();\n      }\n    }\n    ngOnChanges() {\n      if (this.existingData) {\n        this.editId = this.existingData.id;\n        const patch = {\n          ...this.existingData\n        };\n        // Format dates\n        ['date', 'nextFollowUpDate'].forEach(key => {\n          if (patch[key]) patch[key] = patch[key].substring(0, 10);\n        });\n        // Extract and reset comment\n        const {\n          comments,\n          ...rest\n        } = patch;\n        this.salesForm.patchValue({\n          ...rest,\n          comments: ''\n        });\n        this.formattedComments = this.formatOldComments(comments || '');\n        this.existingData = {\n          ...patch\n        };\n        // Disable all first\n        Object.keys(this.salesForm.controls).forEach(field => {\n          this.salesForm.get(field)?.disable();\n        });\n        // Enable editable fields\n        const editableFields = ['salesStage', 'eventLead', 'comments', 'nextFollowUpDate', 'quotationSent', 'sowSent', 'negotiation', 'dealWon'];\n        editableFields.forEach(field => {\n          this.salesForm.get(field)?.enable();\n          this.salesForm.get(field)?.clearValidators(); // remove validations\n          this.salesForm.get(field)?.updateValueAndValidity();\n        });\n      }\n    }\n    formatOldComments(old) {\n      if (!old) return '';\n      const dateStr = new Date().toISOString().slice(0, 10);\n      const lines = old.split('\\n').map(line => {\n        const hasUserInfo = /\\- .+\\(\\d{4}-\\d{2}-\\d{2}\\)/.test(line);\n        return hasUserInfo ? line : `${line} - ${this.loggedInUser} (${dateStr})`;\n      });\n      return lines.join('\\n');\n    }\n    submit() {\n      if (this.salesForm.valid) {\n        const rawData = this.salesForm.getRawValue();\n        const dateStr = new Date().toISOString().slice(0, 10);\n        if (this.editId) {\n          const newComment = rawData.comments?.trim();\n          const formattedNewComment = newComment ? `${newComment} - ${this.loggedInUser} (${dateStr})` : '';\n          const old = this.formattedComments || '';\n          rawData.comments = formattedNewComment ? old ? `${old}\\n${formattedNewComment}` : formattedNewComment : old;\n          this.service.update(this.editId, rawData).subscribe(() => {\n            alert('Updated successfully');\n            this.reset();\n            if (this.refresh) this.refresh();\n          });\n        } else {\n          this.service.create(rawData).subscribe(() => {\n            alert('Saved successfully');\n            this.salesForm.reset();\n            this.salesForm.patchValue({\n              salesName: this.loggedInUser\n            });\n            if (this.refresh) this.refresh();\n          });\n        }\n      } else {\n        this.salesForm.markAllAsTouched();\n        alert('Please fill all required fields.');\n      }\n    }\n    reset() {\n      this.salesForm.reset();\n      this.salesForm.patchValue({\n        salesName: this.loggedInUser,\n        quotationSent: '',\n        sowSent: '',\n        negotiation: '',\n        comments: ''\n      });\n      Object.keys(this.salesForm.controls).forEach(field => {\n        this.salesForm.get(field)?.enable();\n      });\n      this.editId = null;\n      this.existingData = null;\n      this.formattedComments = '';\n    }\n    static {\n      this.ɵfac = function SalesFormComponent_Factory(t) {\n        return new (t || SalesFormComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.SalesService));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: SalesFormComponent,\n        selectors: [[\"app-sales-form\"]],\n        inputs: {\n          existingData: \"existingData\",\n          refresh: \"refresh\",\n          resetEdit: \"resetEdit\"\n        },\n        features: [i0.ɵɵNgOnChangesFeature],\n        decls: 13,\n        vars: 3,\n        consts: [[1, \"bg-black\", \"min-vh-100\", \"py-4\", \"px-2\", \"px-md-3\", \"d-flex\", \"align-items-start\", \"justify-content-center\"], [1, \"card\", \"w-100\", \"shadow-lg\", \"custom-card\", \"text-light\", 2, \"max-width\", \"1000px\"], [1, \"card-body\", \"p-4\"], [1, \"text-center\", \"mb-4\"], [3, \"formGroup\", \"ngSubmit\"], [1, \"row\", \"g-3\"], [4, \"ngIf\"], [1, \"mt-4\", \"text-end\"], [\"type\", \"submit\", 1, \"btn\", \"btn-success\"], [1, \"bi\", \"bi-save\"], [1, \"col-md-4\", \"col-sm-6\"], [1, \"custom-form-group\"], [1, \"custom-input-wrapper\"], [1, \"bi\", \"bi-flag\", \"icon\"], [\"formControlName\", \"salesStage\", 1, \"custom-input\"], [\"value\", \"\"], [4, \"ngFor\", \"ngForOf\"], [1, \"bi\", \"bi-lightbulb\", \"icon\"], [\"type\", \"text\", \"formControlName\", \"eventLead\", 1, \"custom-input\"], [1, \"col-12\", \"mt-3\"], [1, \"text-info\", \"border-bottom\", \"pb-2\"], [1, \"row\"], [\"class\", \"col-md-4 col-sm-6 mb-2\", 4, \"ngFor\", \"ngForOf\"], [1, \"mt-2\"], [1, \"mb-0\", \"text-white\", 2, \"white-space\", \"pre-wrap\"], [1, \"col-md-3\", \"col-sm-6\"], [\"rows\", \"2\", 1, \"custom-input\", 3, \"formControlName\"], [1, \"custom-input\", 3, \"formControlName\"], [\"value\", \"Y\"], [\"value\", \"N\"], [\"type\", \"date\", 1, \"custom-input\", 3, \"formControlName\"], [\"type\", \"number\", \"min\", \"0\", \"placeholder\", \"Enter amount\", 1, \"custom-input\", 3, \"formControlName\"], [1, \"col-md-4\", \"col-sm-6\", \"mb-2\"], [1, \"text-light\"], [1, \"col-md-6\"], [1, \"text-danger\"], [1, \"bi\", \"bi-chat-dots\", \"icon\"], [\"rows\", \"2\", \"formControlName\", \"comments\", 1, \"custom-input\"], [\"class\", \"text-danger small mt-1\", 4, \"ngIf\"], [\"class\", \"text-danger\", 4, \"ngIf\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [3, \"value\"], [\"type\", \"text\", 1, \"custom-input\", 3, \"formControlName\"], [1, \"text-danger\", \"small\", \"mt-1\"]],\n        template: function SalesFormComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"h3\", 3);\n            i0.ɵɵtext(4, \"Sales Opportunity Form\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(5, \"form\", 4);\n            i0.ɵɵlistener(\"ngSubmit\", function SalesFormComponent_Template_form_ngSubmit_5_listener() {\n              return ctx.submit();\n            });\n            i0.ɵɵelementStart(6, \"div\", 5);\n            i0.ɵɵtemplate(7, SalesFormComponent_ng_container_7_Template, 33, 18, \"ng-container\", 6);\n            i0.ɵɵtemplate(8, SalesFormComponent_ng_container_8_Template, 12, 19, \"ng-container\", 6);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(9, \"div\", 7)(10, \"button\", 8);\n            i0.ɵɵelement(11, \"i\", 9);\n            i0.ɵɵtext(12, \" Save \");\n            i0.ɵɵelementEnd()()()()()();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(5);\n            i0.ɵɵproperty(\"formGroup\", ctx.salesForm);\n            i0.ɵɵadvance(2);\n            i0.ɵɵproperty(\"ngIf\", ctx.editId);\n            i0.ɵɵadvance(1);\n            i0.ɵɵproperty(\"ngIf\", !ctx.editId);\n          }\n        },\n        dependencies: [i3.NgForOf, i3.NgIf, i1.ɵNgNoValidate, i1.NgSelectOption, i1.ɵNgSelectMultipleOption, i1.DefaultValueAccessor, i1.NumberValueAccessor, i1.SelectControlValueAccessor, i1.NgControlStatus, i1.NgControlStatusGroup, i1.MinValidator, i1.FormGroupDirective, i1.FormControlName],\n        styles: [\".custom-card[_ngcontent-%COMP%]{background-color:#1c1c1c;border-radius:1rem;color:#da0d0d;overflow-y:auto;max-height:90vh;margin-bottom:1rem}.custom-form-group[_ngcontent-%COMP%]{position:relative;margin-bottom:1.5rem;width:100%}.custom-form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{position:absolute;top:-.6rem;left:1.4rem;font-size:.85rem;background-color:#1c1c1c;padding:0 6px;color:#f1f1f1;z-index:1}.custom-input-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;padding:.5rem .75rem;border:1px solid #ccc;border-radius:6px;background-color:#1c1c1c;width:100%}.custom-input-wrapper[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{color:#17d4ff;font-size:1.1rem;margin-right:.6rem}.custom-input[_ngcontent-%COMP%]{flex:1;background:transparent;border:none;color:#00cafc;font-size:1rem;width:100%}.custom-input[_ngcontent-%COMP%]:focus{outline:none;box-shadow:none}textarea.custom-input[_ngcontent-%COMP%]{resize:vertical;min-height:40px}input[type=date][_ngcontent-%COMP%]::-webkit-calendar-picker-indicator{filter:invert(1);cursor:pointer}@media (max-width: 768px){.custom-card[_ngcontent-%COMP%]{border-radius:0}.card-body[_ngcontent-%COMP%]{padding:1rem}.custom-input-wrapper[_ngcontent-%COMP%]{padding:.45rem .65rem}.custom-input[_ngcontent-%COMP%]{font-size:.95rem}.custom-form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.75rem;top:-.5rem}}\"]\n      });\n    }\n  }\n  return SalesFormComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}